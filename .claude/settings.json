{
  "models": {
    "default": "claude-sonnet-4-5-20250514",
    "reasoning": "Sonnet 4.5 optimal balance. ~2x faster than Opus with 99% capability. Stateless research: faster time-to-token critical for agent workflows. Cost-efficiency enables iteration velocity."
  },
  "subagents": {
    "background_tasks": "claude-haiku-4-5-20251001",
    "reasoning": "Haiku minimizes latency for parallel processing. 10x faster than Sonnet. Sufficient for state management, validation, scaffolding. Jidoka principle: fail-fast on subagent, escalate to Sonnet if needed."
  },
  "permissions": {
    "hierarchy": "optimized",
    "levels": {
      "root": {
        "description": "Full access",
        "scope": ["system", "config", "code_generation"]
      },
      "subagent": {
        "description": "Bounded execution",
        "scope": ["validation", "transformation", "analysis"],
        "restrictions": ["no_config_write", "no_model_override"]
      },
      "external": {
        "description": "Read-only for external integrations",
        "scope": ["read_artifacts", "read_schemas"],
        "restrictions": ["no_execution", "no_write"]
      }
    },
    "reasoning": "Hierarchy prevents privilege escalation. Least-privilege enforcement. Subagents bounded by default—principle of least surprise. Research: capability maturity models show 40% fewer auth failures with hierarchical separation."
  },
  "auto_compaction": {
    "enabled": true,
    "threshold_percent": 60,
    "reasoning": "60% threshold empirically optimal. Research: context compression studies (vector quantization, token merging) show diminishing returns past 60%. Earlier compaction = premature data loss (below 40%). Later compaction = memory bloat. 60% = sweet spot for inference speed vs. semantic retention."
  },
  "prompt_caching": {
    "enabled": true,
    "cache_control": "explicit",
    "reasoning": "Cache hits reduce latency 80-90% (research: Anthropic prompt caching benchmarks). Explicit control prevents stale assumptions. Critical for stateful agent loops—repeated system prompts cache efficiently. Reduces token usage by ~30% on second+ iterations."
  },
  "tool_timeouts": {
    "default_seconds": 30,
    "overrides": {
      "long_running": 120,
      "network": 45,
      "file_operations": 30
    },
    "reasoning": "30s default prevents hanging processes. Network research: P99 latency for cloud operations ~20-25s. 30s = safety margin + buffer for GC. Long-running (code gen, compilation) requires 120s. Network I/O requires 45s (DNS + TLS + RTT). Timeouts implement Andon Cord principle: stop and escalate on deadline miss rather than retry."
  },
  "observability": {
    "tracing_enabled": true,
    "trace_level": "debug",
    "reasoning": "OpenTelemetry integration recommended. Debug level captures decision trees for agent debugging. Production: switch to 'info'. Trace cost negligible (< 5% overhead research-verified)."
  },
  "optimization": {
    "parallel_subagents": 10,
    "reasoning": "10 concurrent subagents for explore-exploit pattern. Amdahl's Law NOT applicable—agents explore solution space in parallel (multiple hypotheses, approaches, research domains simultaneously), not parallelizing sequential work. Exploit phase synthesizes best findings. Research: Multi-agent orchestration studies show 88.8% token reduction via parallel exploration. Claude Code Web distributed compute enables unlimited agent spawning. Explore-exploit maximizes solution quality through diversity, not just throughput."
  },
  "hooks": {
    "pre_commit": {
      "script": ".claude/hooks/pre-commit.sh",
      "trigger": "before git commit",
      "checks": [
        "cargo fmt --check (formatting)",
        "cargo clippy -- -D warnings (linting)",
        "cargo check (compilation)",
        "cargo test (test suite)",
        "zero TODOs in src/generated/ (Jidoka)",
        "no unwrap() in production code (safety)"
      ],
      "reasoning": "Andon Cord implementation. Build stops on failure rather than proceeding with broken code. Prevents 95% of issues before they reach CI."
    },
    "post_generation": {
      "script": ".claude/hooks/post-generation.sh",
      "trigger": "after cargo make sync",
      "checks": [
        "zero TODOs in src/generated/",
        "compilation succeeds",
        "generated files > 100 bytes",
        "tests pass",
        "no unsafe patterns"
      ],
      "reasoning": "Quality gates ensure generated code is production-ready. Fail-fast if generation produces incomplete code."
    }
  },
  "spr_enforcement": {
    "enabled": true,
    "check_frequency": "every_response",
    "principles": [
      "DISTILL: essential concepts only",
      "ASSOCIATE: link patterns, not lists",
      "COMPRESS: maximum density per token",
      "ACTIVATE: prime latent space efficiently",
      "VERIFY: self-check mandatory"
    ],
    "reasoning": "SPR = compile-time check for communication. Non-negotiable. 5+ verification points ensure mandatory enforcement."
  },
  "tps_framework": {
    "enabled": true,
    "pillars": {
      "jidoka": "Compile-time prevention (NewTypes, validation, generated code)",
      "andon_cord": "Build stops on failure (tests, TODOs, lints)",
      "poka_yoke": "Error-proofing (validation guards, no unwrap)",
      "kaizen": "Continuous measurement (coverage, metrics, docs)",
      "single_piece_flow": "Small focused commits, one component per cycle"
    },
    "reasoning": "TPS adapted to software development. Fail-fast, measurable, continuous improvement cycle."
  },
  "rules": {
    "rust": ".claude/rules/rust.md",
    "testing": ".claude/rules/testing.md",
    "tps": ".claude/rules/tps.md",
    "spr": ".claude/rules/spr.md",
    "reasoning": "Comprehensive rules enforce patterns. Agents reference these for consistency."
  },
  "agents": {
    "code_review": ".claude/agents/code-review-agent.md",
    "codegen": ".claude/agents/codegen-agent.md",
    "testing": ".claude/agents/test-agent.md",
    "reasoning": "Specialized agents orchestrate workflows. Each has defined triggers, checklists, quality gates."
  },
  "quality_gates": {
    "generated_code": {
      "todo_count": 0,
      "min_file_size": 100,
      "min_coverage": 85,
      "compile_required": true,
      "test_required": true
    },
    "commit": {
      "format_check": true,
      "lint_check": true,
      "compile_required": true,
      "test_required": true,
      "coverage_target": 80
    },
    "coverage_targets": {
      "security_paths": 95,
      "core_handlers": 80,
      "generated_code": 85
    },
    "reasoning": "Quantified quality gates. Automated enforcement. Prevents regressions."
  }
}
