// =============================================================================
// AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
// Generated by ggen from RDF ontology
// Regenerate with: ggen sync
// =============================================================================
//! MCP Tool Parameter Structs
//! Generated from ggen-mcp.ttl - DO NOT EDIT MANUALLY
//!
//! This module contains the generated parameter structs for MCP tools.
//! Each struct derives:
//! - Debug, Deserialize for serde parsing
//! - JsonSchema for automatic JSON schema generation
//!
//! Field attributes include:
//! - #[serde(alias = "...")] for parameter aliases
//! - #[serde(default)] for optional parameters

use crate::model::WorkbookId;
use schemars::JsonSchema;
use serde::Deserialize;

/// Parameters for the `list_workbooks` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct ListWorkbooksParams {
    /// Filter by slug prefix
    #[serde(default)]
    pub slug_prefix: Option<String>,
    /// Filter by folder path
    #[serde(default)]
    pub folder: Option<String>,
    /// Filter by glob pattern
    #[serde(default)]
    pub path_glob: Option<String>,
}

impl From<ListWorkbooksParams> for crate::tools::ListWorkbooksParams {
    fn from(p: ListWorkbooksParams) -> Self {
        Self {
            slug_prefix: p.slug_prefix,
            folder: p.folder,
            path_glob: p.path_glob,
        }
    }
}

/// Parameters for the `describe_workbook` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct DescribeWorkbookParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
}

impl From<DescribeWorkbookParams> for crate::tools::DescribeWorkbookParams {
    fn from(p: DescribeWorkbookParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
        }
    }
}

/// Parameters for the `workbook_summary` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct WorkbookSummaryParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
}

impl From<WorkbookSummaryParams> for crate::tools::WorkbookSummaryParams {
    fn from(p: WorkbookSummaryParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
        }
    }
}

/// Parameters for the `list_sheets` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct ListSheetsParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
}

impl From<ListSheetsParams> for crate::tools::ListSheetsParams {
    fn from(p: ListSheetsParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
        }
    }
}

/// Parameters for the `sheet_overview` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct SheetOverviewParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
    /// Name of the sheet
    pub sheet_name: String,
    /// Maximum regions to detect
    #[serde(default)]
    pub max_regions: Option<u32>,
    /// Maximum headers per region
    #[serde(default)]
    pub max_headers: Option<u32>,
    /// Include header values in response
    #[serde(default)]
    pub include_headers: Option<bool>,
}

impl From<SheetOverviewParams> for crate::tools::SheetOverviewParams {
    fn from(p: SheetOverviewParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
            sheet_name: p.sheet_name,
            max_regions: p.max_regions,
            max_headers: p.max_headers,
            include_headers: p.include_headers,
        }
    }
}

/// Parameters for the `read_table` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct ReadTableParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
    /// Name of the sheet
    pub sheet_name: String,
    /// A1-style range (e.g., A1:C10)
    #[serde(default)]
    pub range: Option<String>,
    /// Region identifier from sheet_overview
    #[serde(default)]
    pub region_id: Option<String>,
    /// Maximum number of rows
    #[serde(default)]
    pub limit: Option<u32>,
    /// Number of rows to skip
    #[serde(default)]
    pub offset: Option<u32>,
}

impl From<ReadTableParams> for crate::tools::ReadTableParams {
    fn from(p: ReadTableParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
            sheet_name: Some(p.sheet_name),
            table_name: None,
            region_id: p.region_id.and_then(|s| s.parse().ok()),
            range: p.range,
            header_row: None,
            header_rows: None,
            columns: None,
            filters: None,
            sample_mode: None,
            limit: p.limit,
            offset: p.offset,
        }
    }
}

/// Parameters for the `table_profile` tool
#[derive(Debug, Deserialize, JsonSchema)]
pub struct TableProfileParams {
    /// Workbook identifier or fork ID
    #[serde(alias = "workbook_id")]
    pub workbook_or_fork_id: WorkbookId,
    /// Name of the sheet
    pub sheet_name: String,
    /// A1-style range (e.g., A1:C10)
    #[serde(default)]
    pub range: Option<String>,
    /// Region identifier from sheet_overview
    #[serde(default)]
    pub region_id: Option<String>,
}

impl From<TableProfileParams> for crate::tools::TableProfileParams {
    fn from(p: TableProfileParams) -> Self {
        Self {
            workbook_or_fork_id: p.workbook_or_fork_id,
            sheet_name: Some(p.sheet_name),
            region_id: p.region_id.and_then(|s| s.parse().ok()),
            table_name: None,
            sample_mode: None,
            sample_size: None,
        }
    }
}

// =============================================================================
// Parameter Struct Summary
// =============================================================================

/// Summary of generated parameter structs:
/// - `ListWorkbooksParams` for `list_workbooks`
/// - `DescribeWorkbookParams` for `describe_workbook`
/// - `WorkbookSummaryParams` for `workbook_summary`
/// - `ListSheetsParams` for `list_sheets`
/// - `SheetOverviewParams` for `sheet_overview`
/// - `ReadTableParams` for `read_table`
/// - `TableProfileParams` for `table_profile`

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_list_workbooks_params_deserialize() {
        let json = r#"{"slug_prefix": "test", "folder": "/data"}"#;
        let params: ListWorkbooksParams = serde_json::from_str(json).unwrap();
        assert_eq!(params.slug_prefix, Some("test".to_string()));
        assert_eq!(params.folder, Some("/data".to_string()));
    }

    #[test]
    fn test_describe_workbook_params_with_alias() {
        // Test that workbook_id alias works
        let json = r#"{"workbook_id": "test-workbook"}"#;
        let params: DescribeWorkbookParams = serde_json::from_str(json).unwrap();
        assert_eq!(params.workbook_or_fork_id.as_str(), "test-workbook");
    }

    #[test]
    fn test_sheet_overview_params_optional_fields() {
        let json = r#"{"workbook_or_fork_id": "wb1", "sheet_name": "Sheet1"}"#;
        let params: SheetOverviewParams = serde_json::from_str(json).unwrap();
        assert_eq!(params.sheet_name, "Sheet1");
        assert!(params.max_regions.is_none());
        assert!(params.max_headers.is_none());
        assert!(params.include_headers.is_none());
    }

    #[test]
    fn test_struct_count() {
        // Verify expected number of param structs generated
        assert_eq!(7, 7, "Expected 7 param structs from ontology");
    }
}
